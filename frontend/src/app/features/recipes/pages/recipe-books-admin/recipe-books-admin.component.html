<div class="admin-page">
  <!-- Header -->
  <div class="page-header">
    <a routerLink="/recipes" class="back-btn">
      <i class="fa-solid fa-arrow-left"></i>
    </a>
    <div>
      <h1>Recipe Books</h1>
      <p class="subtitle">Manage recipe book collections for your organization</p>
    </div>
  </div>

  <!-- Content Grid -->
  <div class="content-grid">
    <!-- Form Card -->
    <div class="form-card">
      <div class="card-header">
        <i class="fa-solid" [ngClass]="isEditing ? 'fa-edit' : 'fa-plus-circle'"></i>
        <h2>{{ isEditing ? 'Edit Recipe Book' : 'Add New Recipe Book' }}</h2>
      </div>

      <form [formGroup]="bookForm" (ngSubmit)="onSubmit()" class="admin-form">
        <div class="form-group">
          <label for="title">Title *</label>
          <div class="input-wrapper">
            <i class="fa-solid fa-book"></i>
            <input type="text" id="title" formControlName="title" placeholder="E.g., Italian Pasta Collection">
          </div>
          <span class="error-message" *ngIf="bookForm.get('title')?.touched && bookForm.get('title')?.invalid">
            Title is required
          </span>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" formControlName="description" rows="3"
                    placeholder="Brief description of this recipe book"></textarea>
        </div>

        <div class="form-group">
          <label for="site_ids">Sites</label>
          <div class="input-wrapper select-wrapper">
            <i class="fa-solid fa-building"></i>
            <select id="site_ids" formControlName="site_ids" multiple>
              <option *ngFor="let site of sites" [value]="site.id">{{ site.name }}</option>
            </select>
          </div>
          <span class="hint">Leave empty for all sites</span>
        </div>

        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" formControlName="is_active">
            <span>Active</span>
          </label>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-primary" [disabled]="bookForm.invalid">
            <i class="fa-solid" [ngClass]="isEditing ? 'fa-save' : 'fa-plus'"></i>
            {{ isEditing ? 'Update' : 'Create' }} Book
          </button>
          <button type="button" class="btn-secondary" (click)="cancelEdit()" *ngIf="isEditing">
            Cancel
          </button>
        </div>
      </form>
    </div>

    <!-- Table Card -->
    <div class="table-card">
      <div class="card-header">
        <div>
          <i class="fa-solid fa-list"></i>
          <h2>Existing Recipe Books</h2>
        </div>
        <span class="count-badge">{{ recipeBooks.length }}</span>
      </div>

      <div class="table-wrapper" *ngIf="recipeBooks.length > 0">
        <table>
          <thead>
            <tr>
              <th>Title</th>
              <th>Sites</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let book of recipeBooks">
              <td>
                <strong>{{ book.title }}</strong>
                <span class="description" *ngIf="book.description">{{ book.description }}</span>
              </td>
              <td>
                <span class="site-badge all" *ngIf="!book.sites || book.sites.length === 0">All Sites</span>
                <span class="site-badge" *ngFor="let site of book.sites">{{ site.name }}</span>
              </td>
              <td>
                <span class="status-badge" [class.active]="book.is_active" [class.inactive]="!book.is_active">
                  {{ book.is_active ? 'Active' : 'Inactive' }}
                </span>
              </td>
              <td>
                <div class="action-buttons">
                  <button class="action-btn edit" (click)="editBook(book)" title="Edit">
                    <i class="fa-solid fa-edit"></i>
                  </button>
                  <button class="action-btn delete" (click)="deleteBook(book)" title="Delete">
                    <i class="fa-solid fa-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="empty-state" *ngIf="recipeBooks.length === 0">
        <i class="fa-solid fa-book-bookmark"></i>
        <p>No recipe books found. Create your first recipe book using the form.</p>
      </div>
    </div>
  </div>
</div>
