<div class="admin-page">
  <!-- Header -->
  <div class="page-header">
    <a routerLink="/recipes" class="back-btn">
      <i class="fa-solid fa-arrow-left"></i>
    </a>
    <div>
      <h1>Ingredient Units</h1>
      <p class="subtitle">Manage measurement units for recipe ingredients</p>
    </div>
  </div>

  <div class="content-grid">
    <!-- Left Panel: Form -->
    <div class="left-panel">
      <div class="form-card">
        <div class="card-header">
          <i class="fa-solid" [ngClass]="isEditing ? 'fa-edit' : 'fa-plus-circle'"></i>
          <h2>{{ isEditing ? 'Edit Unit' : 'Add New Unit' }}</h2>
        </div>
        <form [formGroup]="unitForm" (ngSubmit)="onSubmit()" class="admin-form">
          <div class="form-row">
            <div class="form-group">
              <label for="name">Unit Code</label>
              <div class="input-wrapper">
                <i class="fa-solid fa-code"></i>
                <input type="text" id="name" formControlName="name" placeholder="e.g., kg">
              </div>
              <span class="hint">Short code used internally</span>
              <span class="error-message" *ngIf="unitForm.get('name')?.touched && unitForm.get('name')?.hasError('required')">
                Code is required
              </span>
            </div>

            <div class="form-group">
              <label for="display_name">Display Name</label>
              <div class="input-wrapper">
                <i class="fa-solid fa-tag"></i>
                <input type="text" id="display_name" formControlName="display_name" placeholder="e.g., Kilograms">
              </div>
              <span class="hint">Name shown to users</span>
              <span class="error-message" *ngIf="unitForm.get('display_name')?.touched && unitForm.get('display_name')?.hasError('required')">
                Display name is required
              </span>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="category">Category</label>
              <div class="input-wrapper">
                <i class="fa-solid fa-folder"></i>
                <select id="category" formControlName="category">
                  <option value="">None</option>
                  <option *ngFor="let cat of categories" [value]="cat">
                    {{ cat | titlecase }}
                  </option>
                </select>
              </div>
              <span class="hint">Group units by type</span>
            </div>

            <div class="form-group">
              <label for="sort_order">Sort Order</label>
              <div class="input-wrapper">
                <i class="fa-solid fa-sort"></i>
                <input type="number" id="sort_order" formControlName="sort_order" placeholder="0">
              </div>
              <span class="hint">Lower numbers appear first</span>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn-primary" [disabled]="unitForm.invalid">
              <i class="fa-solid" [ngClass]="isEditing ? 'fa-save' : 'fa-plus'"></i>
              {{ isEditing ? 'Update' : 'Create' }} Unit
            </button>
            <button type="button" class="btn-secondary" (click)="resetForm()" *ngIf="isEditing">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Right Panel: Table -->
    <div class="right-panel">
      <div class="table-card">
        <div class="card-header">
          <div>
            <i class="fa-solid fa-balance-scale"></i>
            <h2>Existing Units</h2>
          </div>
          <span class="count-badge">{{ units.length }} units</span>
        </div>
        <div class="table-wrapper">
          <table *ngIf="units.length > 0">
            <thead>
              <tr>
                <th>Code</th>
                <th>Display Name</th>
                <th>Category</th>
                <th>Order</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let unit of units">
                <td><span class="code-cell">{{ unit.name }}</span></td>
                <td><strong>{{ unit.display_name }}</strong></td>
                <td>
                  <span *ngIf="unit.category" class="category-badge" [ngClass]="unit.category">
                    {{ unit.category }}
                  </span>
                  <span *ngIf="!unit.category" class="text-muted">-</span>
                </td>
                <td class="text-center">{{ unit.sort_order }}</td>
                <td>
                  <div class="action-buttons">
                    <button type="button" class="action-btn edit" (click)="editUnit(unit)" title="Edit">
                      <i class="fa-solid fa-edit"></i>
                    </button>
                    <button type="button" class="action-btn delete" (click)="deleteUnit(unit)" title="Delete">
                      <i class="fa-solid fa-trash"></i>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>

          <div class="empty-state" *ngIf="units.length === 0">
            <i class="fa-solid fa-balance-scale"></i>
            <p>No units found. Create your first unit using the form.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
