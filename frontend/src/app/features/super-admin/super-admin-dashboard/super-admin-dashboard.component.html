<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Super Admin Dashboard</h1>
    <button mat-raised-button color="primary" (click)="refresh()" [disabled]="loading">
      <mat-icon>refresh</mat-icon>
      Refresh
    </button>
  </div>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner></mat-spinner>
  </div>

  <div *ngIf="error" class="error-container">
    <mat-icon color="warn">error</mat-icon>
    <p>{{ error }}</p>
    <button mat-button color="primary" (click)="refresh()">Try Again</button>
  </div>

  <div *ngIf="!loading && !error && metrics" class="metrics-grid">
    <mat-card class="metric-card">
      <mat-card-content>
        <div class="metric-icon" style="background-color: #667eea;">
          <mat-icon>business</mat-icon>
        </div>
        <div class="metric-details">
          <h3>{{ metrics.total_organizations }}</h3>
          <p>Total Organizations</p>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-content>
        <div class="metric-icon" style="background-color: #f093fb;">
          <mat-icon>location_on</mat-icon>
        </div>
        <div class="metric-details">
          <h3>{{ metrics.total_sites }}</h3>
          <p>Total Sites</p>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-content>
        <div class="metric-icon" style="background-color: #4facfe;">
          <mat-icon>people</mat-icon>
        </div>
        <div class="metric-details">
          <h3>{{ metrics.total_users }}</h3>
          <p>Total Users</p>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-content>
        <div class="metric-icon" style="background-color: #43e97b;">
          <mat-icon>credit_card</mat-icon>
        </div>
        <div class="metric-details">
          <h3>{{ metrics.active_subscriptions }}</h3>
          <p>Active Subscriptions</p>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-content>
        <div class="metric-icon" style="background-color: #fa709a;">
          <mat-icon>checklist</mat-icon>
        </div>
        <div class="metric-details">
          <h3>{{ metrics.total_checklists_today }}</h3>
          <p>Checklists Today</p>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-content>
        <div class="metric-icon" style="background-color: #ff6b6b;">
          <mat-icon>bug_report</mat-icon>
        </div>
        <div class="metric-details">
          <h3>{{ metrics.total_open_defects }}</h3>
          <p>Open Defects</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <div *ngIf="!loading && !error && metrics" class="activity-section">
    <mat-card>
      <mat-card-header>
        <mat-card-title>Recent Activity</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div *ngIf="metrics.recent_activity.length === 0" class="no-activity">
          <p>No recent activity</p>
        </div>
        <mat-list *ngIf="metrics.recent_activity.length > 0">
          <mat-list-item *ngFor="let activity of metrics.recent_activity">
            <mat-icon matListItemIcon>notifications</mat-icon>
            <div matListItemTitle>{{ activity.description }}</div>
            <div matListItemLine>{{ activity.timestamp | date:'short' }}</div>
          </mat-list-item>
        </mat-list>
      </mat-card-content>
    </mat-card>
  </div>
</div>
